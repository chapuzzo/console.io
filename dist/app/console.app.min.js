/**
 * Name: console.io
 * Version: 0.2.5
 * Description: Javascript Remote Web Console
 * Website: http://nkashyap.github.io/console.io/
 * Author: Nisheeth Kashyap
 * Email: nisheeth.k.kashyap@gmail.com
 * Date: 2015-03-04
*/

"undefined"==typeof window.ConsoleIO&&(window.ConsoleIO={domReady:!1,namespace:function(a){var b,c=a.split("."),d=window,e=c.length;for(b=0;e>b;b++)d=d[c[b]]=d[c[b]]||{}},getOrigin:function(){return window.location.origin||window.location.protocol+"//"+(window.location.host||window.location.hostname+":"+window.location.port)},ready:function(a){function b(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",b,!1),a()):document.attachEvent&&"complete"===document.readyState&&(document.detachEvent("onreadystatechange",b),a())}"complete"===document.readyState&&setTimeout(a,1),document.addEventListener?(document.addEventListener("DOMContentLoaded",b,!1),window.addEventListener("load",a,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",b),window.attachEvent("onload",a))},addEventListener:function(a,b,c){return a.addEventListener?(a.addEventListener(b,c,!1),!0):a.attachEvent?a.attachEvent("on"+b,c):(b="on"+b,"function"==typeof a[b]&&(c=function(a,b){return function(){a.apply(this,arguments),b.apply(this,arguments)}}(a[b],c)),a[b]=c,!0)},removeEventListener:function(a,b,c){return a.removeEventListener?(a.removeEventListener(b,c,!1),!0):a.detachEvent?a.detachEvent("on"+b,c):(b="on"+b,"function"==typeof a[b]&&(a[b]=null),!0)},every:function(){return Array.prototype.every?function(a,b,c){return(a||[]).every(b,c)}:function(a,b,c){a=a||[];var d=0,e=a.length;if(e)do if(!b.call(c||a,a[d],d,a))return!1;while(++d<e);return!0}}(),forEach:function(){return Array.prototype.forEach?function(a,b,c){(a||[]).forEach(b,c)}:function(a,b,c){a=a||[];var d=0,e=a.length;if(e)do b.call(c||a,a[d],d,a);while(++d<e)}}(),queryParams:function(a){var b={};return a&&a.length>0&&(a=a.replace(/"/gim,""),a.indexOf("?")>-1?(a=a.split("?"),b.URL=a[0],a=a[1],this.forEach(a.split("&"),function(a){a=a.split("="),this[a[0]]=a[1]},b)):b.URL=a),b},cookieToJSON:function(a){var b={};return this.forEach(unescape(a).split("; "),function(a){a=a.split("="),this[a[0]]=a[1]},b),b},forEachProperty:function(a,b,c){var d;for(d in a)b.call(c||a,a[d],d,a)},toArray:function(a){return Array.prototype.slice.call(a)},isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},keys:Object.keys||function(a){var b,c=[],d=Object.prototype.hasOwnProperty;for(b in a)d.call(a,b)&&c.push(b);return c},extend:function(a,b){return this.forEachProperty(b,function(b,c){a[c]=b}),a},async:function(a,b,c){return setTimeout(function(){a.call(b)},c||4)},getUniqueId:function(){var a=1e5;return function(){return++a}}(),addCSSRule:function(a,b,c){var d=ConsoleIO.styleSheet;try{d.insertRule?d.insertRule(a+"{"+b+"}",c):d.addRule&&d.addRule(a,b,c)}catch(e){}},deleteCSSRule:function(a){var b=ConsoleIO.styleSheet,c=b.cssRules||b.rules;this.forEach(this.toArray(c),function(c,d){c.selectorText&&c.selectorText.replace("::",":")===a.replace("::",":")&&(b.deleteRule?b.deleteRule(d):b.removeRule&&b.removeRule(d))})}}),ConsoleIO.namespace("ConsoleIO.Service.Socket"),ConsoleIO.Service.Socket={io:null,name:null,guid:null,connectionMode:null,connect:function(){var a=ConsoleIO.getOrigin();ConsoleIO.Service.Socket.guid=ConsoleIO.Service.Storage.getItem("guid"),ConsoleIO.Service.Socket.guid||(ConsoleIO.Service.Socket.guid=((new Date).getTime()+"-"+Math.random()).replace(".",""),ConsoleIO.Service.Storage.addItem("guid",ConsoleIO.Service.Socket.guid,365)),this.io=window.io.connect(a,{secure:a.indexOf("https")>-1,resource:(window.location.pathname.split("/").slice(0,-1).join("/")+"/socket.io").substring(1),"sync disconnect on unload":!0}),this.io.on("connect",this.onConnect),this.io.on("connecting",this.onConnecting),this.io.on("reconnect",this.onReconnect),this.io.on("disconnect",this.onDisconnect)},emit:function(a,b){this.io&&this.io.socket.connected&&this.io.emit("user:"+a,b||{})},on:function(a,b,c){this.io.on(a,function(){b.apply(c||this,arguments)})},off:function(a,b,c){this.io.removeListener(a,function(){b.apply(c||this,arguments)}),ConsoleIO.isArray(this.io.$events[a])||delete this.io.$events[a]},forceReconnect:function(){try{var a=ConsoleIO.Service.Socket;a.io.socket.disconnectSync(),a.io.socket.reconnect()}catch(b){console.warn(b)}},onConnect:function(){ConsoleIO.Service.Socket.emit("setUp")},onConnecting:function(a){ConsoleIO.Service.Socket.connectionMode=a},onReconnect:function(a){ConsoleIO.Service.Socket.connectionMode=a},onDisconnect:function(a){(!a||a&&"booted"!==a)&&ConsoleIO.Service.Socket.forceReconnect()}},ConsoleIO.namespace("ConsoleIO.Service.Storage"),ConsoleIO.Service.Storage={Store:{},addItem:function(a,b,c){if(b&&"undefined"!==b){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}document.cookie=a+"="+b+d+"; path=/",ConsoleIO.Service.Storage.Store[a]=b}},removeItem:function(a){this.addItem(a,"",-1),delete ConsoleIO.Service.Storage.Store[a]},getItem:function(a){return ConsoleIO.Service.Storage.Store[a]}},ConsoleIO.namespace("ConsoleIO.Service.DHTMLXHelper"),ConsoleIO.Service.DHTMLXHelper={populateToolbar:function(a,b){ConsoleIO.forEach(a,function(a,b){switch(a.type){case"button":this.addButton(a.id,b,a.text,a.imgEnabled,a.imgDisabled);break;case"separator":this.addSeparator("separator+"+b,b);break;case"twoState":this.addButtonTwoState(a.id,b,a.text,a.imgEnabled,a.imgDisabled),this.setItemState(a.id,!!a.pressed);break;case"select":"pagesizes"===a.opts&&(a.opts=[],ConsoleIO.forEach(ConsoleIO.Settings.pageSize.list,function(b){a.opts.push([a.id+"-"+b,"obj",b])}),a.selected=a.id+"-"+ConsoleIO.Settings.pageSize.active),this.addButtonSelect(a.id,b,a.text,a.opts,a.imgEnabled,a.imgDisabled),a.selected&&this.setListOptionSelected(a.id,a.selected);break;case"text":this.addText(a.id,b,a.text);break;case"input":this.addInput(a.id,b,"triggerInterval"===a.id?ConsoleIO.Settings.triggerInterval:a.value)}a.disabled&&this.disableItem(a.id),a.hidden&&this.hideItem(a.id),a.width&&this.setWidth(a.id,a.width),a.tooltip&&this.setItemToolTip(a.id,a.tooltip)},b)},elements:{},createElement:function(a){a.tag=a.tag||"div",this.elements[a.tag]||(this.elements[a.tag]=document.createElement(a.tag));var b=this.elements[a.tag].cloneNode(!1);return ConsoleIO.forEachProperty(a.attr,function(a,c){a&&b.setAttribute(c,a)}),ConsoleIO.forEachProperty(a.prop,function(a,c){a&&(b[c]=a)}),a.target&&(a.insert&&"top"===a.insert?a.target.insertBefore(b,a.target.firstElementChild||a.target.firstChild):a.target.appendChild(b)),b},stripBrackets:function(a){var b=a.length-1;return"["===a.charAt(0)&&"]"===a.charAt(b)?a.substring(1,b):a}},ConsoleIO.namespace("ConsoleIO.Model.DHTMLX"),ConsoleIO.Model.DHTMLX={ToolBarItem:{Separator:{type:"separator"},PageSize:{id:"pagesize",type:"select",text:"PageSize",imgEnabled:"pagesize.png",tooltip:"Page Size",width:90,opts:"pagesizes"},Source:{id:"source",type:"twoState",text:"Source",imgEnabled:"source.png",imgDisabled:"source_dis.png",tooltip:"Source",pressed:!0},Preview:{id:"preview",type:"twoState",text:"Preview",imgEnabled:"preview.png",imgDisabled:"preview_dis.png",tooltip:"Preview",pressed:!1},ScreenShot:{id:"screenShot",type:"button",text:"Capture",imgEnabled:"screenshot.png",imgDisabled:"screenshot_dis.png",tooltip:"ScreenShot"},TriggerLabel:{id:"triggerLabel",type:"text",text:"Trigger Interval"},TriggerInterval:{id:"triggerInterval",type:"input",value:"",width:100,tooltip:"Trigger interval"},KeyPress:{id:"KeyPress",type:"twoState",text:"KeyPress",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"KeyPress"},KeyDown:{id:"KeyDown",type:"twoState",text:"KeyDown",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"KeyDown"},KeyUp:{id:"KeyUp",type:"twoState",text:"KeyUp",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"KeyUp"},MouseMove:{id:"MouseMove",type:"twoState",text:"MouseMove",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"MouseMove"},MouseOver:{id:"MouseOver",type:"twoState",text:"MouseOver",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"MouseOver"},MouseOut:{id:"MouseOut",type:"twoState",text:"MouseOut",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"MouseOut"},MouseEnter:{id:"MouseEnter",type:"twoState",text:"MouseEnter",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"MouseEnter"},MouseLeave:{id:"MouseLeave",type:"twoState",text:"MouseLeave",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"MouseLeave"},Click:{id:"Click",type:"twoState",text:"Click",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"Click"},DblClick:{id:"DblClick",type:"twoState",text:"DoubleClick",imgEnabled:"connect.png",imgDisabled:"connect_dis.png",tooltip:"DoubleClick"},DeviceNameLabel:{id:"deviceNameLabel",type:"text",text:"Device Name:",tooltip:"Device Name"},DeviceNameText:{id:"deviceNameText",type:"input",value:"",width:120,tooltip:"Enter Device Name"},DeviceNameSet:{id:"deviceNameSet",type:"button",imgEnabled:"go.png",tooltip:"Set Device Name"},SearchText:{id:"searchText",type:"input",value:"",width:100,tooltip:"Search Text"},Search:{id:"search",type:"button",imgEnabled:"search.png",imgDisabled:"search_dis.png",tooltip:"Search"},Execute:{id:"execute",type:"button",text:"Execute",imgEnabled:"execute.png",imgDisabled:"execute_dis.png",tooltip:"Execute (Ctrl+Enter)"},Clear:{id:"clear",type:"button",text:"Clear",imgEnabled:"clear.png",tooltip:"Clear"},Refresh:{id:"refresh",type:"button",text:"Refresh",imgEnabled:"refresh.png",tooltip:"Refresh"},Reload:{id:"reload",type:"button",text:"Reload",imgEnabled:"reload.png",tooltip:"Reload Browser"},Open:{id:"open",type:"select",text:"Open",imgEnabled:"open.png",imgDisabled:"open_dis.png",tooltip:"Open",opts:[]},Save:{id:"save",type:"select",text:"Save",imgEnabled:"save.png",imgDisabled:"save_dis.png",tooltip:"Save",disabled:!0,opts:[["saveAs","obj","Save As","save_as.png"]]},Export:{id:"export",type:"button",text:"Export",imgEnabled:"downloads.png",tooltip:"Export"},Undo:{id:"undo",type:"button",text:"Undo",imgEnabled:"undo.png",imgDisabled:"undo_dis.png",tooltip:"Undo",disabled:!0},Redo:{id:"redo",type:"button",text:"Redo",imgEnabled:"redo.png",imgDisabled:"redo_dis.png",tooltip:"Redo",disabled:!0},SelectAll:{id:"selectAll",type:"button",text:"Select All",imgEnabled:"select_all.png",imgDisabled:"select_all_dis.png",tooltip:"Select All"},Cut:{id:"cut",type:"button",text:"Cut",imgEnabled:"cut.png",imgDisabled:"cut_dis.png",tooltip:"Cut"},Copy:{id:"copy",type:"button",text:"Copy",imgEnabled:"copy.png",imgDisabled:"copy_dis.png",tooltip:"Copy"},Paste:{id:"paste",type:"button",text:"Paste",imgEnabled:"paste.png",imgDisabled:"paste_dis.png",tooltip:"Paste"},Profiler:{id:"profiler",type:"twoState",text:"Start Profiling",imgEnabled:"rec.png",imgDisabled:"rec_dis.png",tooltip:"Start CPU Profiling",pressed:!1},ProfileView:{id:"displaySelector",type:"select",text:"Tree (Top Down)",width:110,hidden:!0,disabled:!0,opts:[["heavy","obj","Heavy (Bottom Up)"],["tree","obj","Tree (Top Down)"]]},TimeOrPercent:{id:"timePercent",type:"twoState",imgEnabled:"percent.png",imgDisabled:"percent.png",tooltip:"Show total and self time in percentage",hidden:!0,disabled:!0,pressed:!1},FocusFn:{id:"focusFn",type:"button",imgEnabled:"zoom.png",imgDisabled:"zoom_dis.png",tooltip:"Focus selected function",hidden:!0,disabled:!0},RestoreFn:{id:"restoreFn",type:"button",imgEnabled:"undo.png",imgDisabled:"undo_dis.png",tooltip:"Restore all functions",hidden:!0,disabled:!0},ExcludeFn:{id:"excludeFn",type:"button",imgEnabled:"clear.png",imgDisabled:"clear_dis.png",tooltip:"Exclude selected function",hidden:!0,disabled:!0},Web:{id:"web",type:"twoState",text:"Web Console",imgEnabled:"console.png",tooltip:"Web Console",pressed:!1},PlayPause:{id:"playPause",type:"twoState",text:"Pause",imgEnabled:"pause.png",tooltip:"Pause logs",pressed:!1},WordWrap:{id:"wordwrap",type:"twoState",text:"Word-Wrap",imgEnabled:"word_wrap.png",imgDisabled:"word_wrap_dis.png",tooltip:"Word Wrap",pressed:!1},Beautify:{id:"beautify",type:"twoState",text:"Beautify",imgEnabled:"beautify.png",imgDisabled:"beautify_dis.png",tooltip:"Beautify",pressed:!1},FilterLabel:{id:"filterLabel",type:"text",text:"Filters:",tooltip:"Filter Console Logs"},Info:{id:"filter-info",type:"twoState",text:"Info",imgEnabled:"info.png",tooltip:"Info",pressed:!1},Log:{id:"filter-log",type:"twoState",text:"Log",imgEnabled:"log.png",tooltip:"Log",pressed:!1},Warn:{id:"filter-warn",type:"twoState",text:"Warn",imgEnabled:"warn.png",tooltip:"Warn",pressed:!1},Debug:{id:"filter-debug",type:"twoState",text:"Debug",imgEnabled:"debug.png",tooltip:"Debug",pressed:!1},Trace:{id:"filter-trace",type:"twoState",text:"Trace",imgEnabled:"trace.png",tooltip:"Trace",pressed:!1},Error:{id:"filter-error",type:"twoState",text:"Error",imgEnabled:"error.png",tooltip:"Error",pressed:!1}}},ConsoleIO.namespace("ConsoleIO.View.App"),ConsoleIO.View.App=function(a,b){this.ctrl=a,this.model=b,this.layout=null,this.statusBar=null},ConsoleIO.View.App.prototype.render=function(){this.layout=new dhtmlXLayoutObject(this.model.target,this.model.type,ConsoleIO.Constant.THEMES.get("layout")),this.layout.cont.obj._offsetTop=5,this.layout.cont.obj._offsetLeft=5,this.layout.cont.obj._offsetHeight=-10,this.layout.cont.obj._offsetWidth=-10,this.layout.setSizes(),this.layout.setEffect("resize",!0),this.statusBar=this.layout.attachStatusBar(),this.statusBar.setText(this.model.status)},ConsoleIO.View.App.prototype.setTitle=function(a,b){this.layout&&(this.layout.cells(a).setText(b),this.layout.setCollapsedText(a,b))},ConsoleIO.View.App.prototype.getContextById=function(a){return this.layout?this.layout.cells(a):null},ConsoleIO.namespace("ConsoleIO.View.Device"),ConsoleIO.View.Device=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.tabs=null},ConsoleIO.View.Device.prototype.render=function(a){this.target=a,this.tabs=this.target.attachTabbar(),this.tabs.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("tab")),this.tabs.attachEvent("onTabClick",function(a){this.onTabClick(a.split("-")[0].toLowerCase())},this.ctrl)},ConsoleIO.View.Device.prototype.destroy=function(){this.tabs.clearAll()},ConsoleIO.namespace("ConsoleIO.View.Browser"),ConsoleIO.View.Browser=function(a,b){this.ctrl=a,this.model=b,this.tree=null,this.target=null,this.toolbar=null},ConsoleIO.View.Browser.prototype.render=function(a){var b=this;this.target=a,this.target.setWidth(this.model.width),this.target.setHeight(this.model.height),this.toolbar=this.target.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar),this.tree=this.target.attachTree(),this.tree.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("tree")),this.tree.setIconPath(ConsoleIO.Settings.iconPath),this.tree.enableHighlighting(!0),this.tree.enableTreeImages(!0),this.tree.enableTreeLines(!0),this.tree.enableIEImageFix(!0),this.tree.attachEvent("onDblClick",function(a){b.tree.hasChildren(a)||b.ctrl.subscribe(a)}),this.tree.attachEvent("onOpenEnd",function(a,c){b.tree.hasChildren(a)&&this.openNode(a,c)},this.ctrl)},ConsoleIO.View.Browser.prototype.add=function(a,b,c,d){this.tree.getParentId(a)||(d?this.tree.insertNewItem(c,a,b,0,d,d,d):this.tree.insertNewItem(c,a,b))},ConsoleIO.View.Browser.prototype.addOrUpdate=function(a,b,c,d){this.tree.getParentId(a)&&this.tree.deleteItem(a),d?this.tree.insertNewItem(c,a,b,0,d,d,d):this.tree.insertNewItem(c,a,b)},ConsoleIO.View.Browser.prototype.deleteItem=function(a){this.tree.deleteItem(a)},ConsoleIO.View.Browser.prototype.closeItem=function(a,b){b?this.tree.closeAllItems(a):this.tree.closeItem(a)},ConsoleIO.View.Browser.prototype.setIcon=function(a,b){this.tree.setItemImage(a,b)},ConsoleIO.namespace("ConsoleIO.View.Device.Console"),ConsoleIO.View.Device.Console=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.tab=null,this.toolbar=null,this.id=[this.model.name,this.model.serialNumber].join("-"),this.container=ConsoleIO.Service.DHTMLXHelper.createElement({attr:{id:"console-"+this.id}})},ConsoleIO.View.Device.Console.prototype.render=function(a){this.target=a,this.target.addTab(this.id,this.model.name),this.target.setContent(this.id,this.container),this.tab=this.target.cells(this.id),this.toolbar=this.tab.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.toolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),this.toolbar.attachEvent("onEnter",function(a,b){this.applySearch(b)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar)},ConsoleIO.View.Device.Console.prototype.destroy=function(){this.clear(),this.container.parentNode.removeChild(this.container),this.target.removeTab(this.id)},ConsoleIO.View.Device.Console.prototype.add=function(a){var b=this.getElementData(a);ConsoleIO.Service.DHTMLXHelper.createElement({tag:b.tag,attr:{"class":b.className},prop:{innerHTML:b.message},target:this.container,insert:"top"}),this.removeOverflowElement()},ConsoleIO.View.Device.Console.prototype.addBatch=function(a){if(a.length>0){var b=document.createDocumentFragment();ConsoleIO.forEach(a,function(a){var c=this.getElementData(a);ConsoleIO.Service.DHTMLXHelper.createElement({tag:c.tag,attr:{"class":c.className},prop:{innerHTML:c.message},target:b,insert:"bottom"})},this),this.container.insertBefore(b,this.container.firstElementChild||this.container.firstChild),this.removeOverflowElement()}},ConsoleIO.View.Device.Console.prototype.clear=function(){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild)},ConsoleIO.View.Device.Console.prototype.removeOverflowElement=function(){for(var a=this.container.childElementCount||this.container.children.length;a>ConsoleIO.Settings.pageSize.active;)this.container.removeChild(this.container.lastElementChild||this.container.lastChild),a--},ConsoleIO.View.Device.Console.prototype.setTabActive=function(){this.target.setTabActive(this.id)},ConsoleIO.View.Device.Console.prototype.setItemState=function(a,b){this.toolbar&&this.toolbar.setItemState(a,b)},ConsoleIO.View.Device.Console.prototype.setValue=function(a,b){this.toolbar&&this.toolbar.setValue(a,b)},ConsoleIO.View.Device.Console.prototype.getElementData=function(a){a.message=unescape(a.message);var b,c,d,e="code",f=a.type,g=a.origin,h=ConsoleIO.Service.DHTMLXHelper.stripBrackets(a.message);if("assert"===a.type){var i=ConsoleIO.Service.DHTMLXHelper.stripBrackets(h).split(",");"true"!==i[0].toLowerCase()&&(f="assert-failed")}if(h=h.replace(/%20/gim," "),h.indexOf("{")>-1&&h.indexOf("}")>-1&&(e="pre"),d=prettyPrintOne(h),a.stack){var j=a.stack.split(",").join("\n").replace(/"/gim,"").replace(/%20/gim," ");c=ConsoleIO.Service.DHTMLXHelper.stripBrackets(j),d+="\n"+prettyPrintOne(c)}return["assert","dir","dirxml","error","trace"].indexOf(a.type)>-1&&(e="pre"),g&&(g=a.origin.replace(/(\/|:|\.)/gim,""),b="content: 'iframe:"+a.origin+"'; position: absolute; top: 0px; right: 0px; padding: 2px 8px; font-size: 12px; color: lightgrey; background-color: rgba(0, 0, 0, 0.6); font-family: Monaco,Menlo,Consolas,'Courier New',monospace;",ConsoleIO.deleteCSSRule("."+g+":before"),ConsoleIO.addCSSRule("."+g+":before",b)),{tag:e,className:"console type-"+f+(g?" "+g:""),message:d||"."}},ConsoleIO.View.Device.Console.prototype.getHTML=function(){return this.container.innerHTML},ConsoleIO.View.Device.Console.prototype.getValue=function(a){return this.toolbar.getValue(a)},ConsoleIO.namespace("ConsoleIO.View.Device.Explorer"),ConsoleIO.View.Device.Explorer=function(a,b){this.ctrl=a,this.model=b,this.tree=null,this.target=null,this.toolbar=null},ConsoleIO.View.Device.Explorer.prototype.render=function(a){var b=this;this.target=a,this.target.setWidth(this.model.width),this.toolbar=this.target.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar),this.tree=this.target.attachTree(),this.tree.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("tree")),this.tree.setIconPath(ConsoleIO.Settings.iconPath),this.tree.enableHighlighting(!0),this.tree.enableTreeImages(!0),this.tree.enableTreeLines(!0),this.tree.enableIEImageFix(!0),this.tree.attachEvent("onDblClick",function(a){b.tree.hasChildren(a)||this.onDblClick(a)},this.ctrl),this.tree.attachEvent("onOpenEnd",function(a,c){b.tree.hasChildren(a)&&this.onOpenEnd(a,c)},this.ctrl)},ConsoleIO.View.Device.Explorer.prototype.destroy=function(){this.tree.destructor()},ConsoleIO.View.Device.Explorer.prototype.add=function(a,b,c,d){d?this.tree.insertNewItem(c,a,b,0,d,d,d):this.tree.insertNewItem(c,a,b)},ConsoleIO.View.Device.Explorer.prototype.getSelectedId=function(){return this.tree.getSelectedItemId()},ConsoleIO.View.Device.Explorer.prototype.deleteItem=function(a){this.tree.deleteItem(a)},ConsoleIO.View.Device.Explorer.prototype.closeItem=function(a,b){b?this.tree.closeAllItems(a):this.tree.closeItem(a)},ConsoleIO.View.Device.Explorer.prototype.setIcon=function(a,b){this.tree.setItemImage(a,b)},ConsoleIO.namespace("ConsoleIO.View.Device.HTML"),ConsoleIO.View.Device.HTML=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.toolbar=null,this.previewToolbar=null,this.tab=null,this.dhxWins=null,this.previewFrame=null,this.image=null,this.id=[this.model.name,this.model.serialNumber].join("-")},ConsoleIO.View.Device.HTML.prototype.render=function(a){this.target=a,this.target.addTab(this.id,this.model.name),this.tab=this.target.cells(this.id),this.toolbar=this.tab.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.toolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar),this.previewBar=ConsoleIO.Service.DHTMLXHelper.createElement({tag:"div",attr:{width:"100%"}}),this.previewFrame=ConsoleIO.Service.DHTMLXHelper.createElement({tag:"iframe",attr:{height:"100%",width:"100%",style:"display:none;"},target:document.body}),this.image=ConsoleIO.Service.DHTMLXHelper.createElement({tag:"img",target:document.body}),this.dhxWins=new dhtmlXWindows,this.dhxWins.enableAutoViewport(!0),this.dhxWins.attachViewportTo(document.body),this.dhxWins.setSkin(ConsoleIO.Constant.THEMES.get("win")),this.dhxWins.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("win"))},ConsoleIO.View.Device.HTML.prototype.destroy=function(){document.body.removeChild(this.previewFrame),document.body.removeChild(this.image),this.dhxWins.unload(),this.target.removeTab(this.id)},ConsoleIO.View.Device.HTML.prototype.toggleButton=function(a,b){var c=ConsoleIO.Model.DHTMLX.ToolBarItem[a];this.toolbar&&c&&(b?this.toolbar.enableItem(c.id):this.toolbar.disableItem(c.id))},ConsoleIO.View.Device.HTML.prototype.show=function(){this.previewFrame.style.display="block",this.tab.attachObject(this.previewFrame)},ConsoleIO.View.Device.HTML.prototype.hide=function(){this.previewFrame.style.display="none",this.tab.detachObject(this.previewFrame)},ConsoleIO.View.Device.HTML.prototype.preview=function(a){this.unbind(),this.previewFrame.src="javascript:false;",ConsoleIO.async(function(){var b=this.previewFrame.contentWindow.document;b.head.innerHTML=(a.style||"")+(a.links||""),b.body.innerHTML=a.body,this.bind()},this)},ConsoleIO.View.Device.HTML.prototype.bind=function(){var a=this.previewFrame.contentWindow||this.previewFrame.contentDocument;a.document&&ConsoleIO.forEachProperty(this.ctrl.events,function(b,c){ConsoleIO.addEventListener(a.document.body,c,b)},this.ctrl)},ConsoleIO.View.Device.HTML.prototype.unbind=function(){var a=this.previewFrame.contentWindow||this.previewFrame.contentDocument;a.document&&ConsoleIO.forEachProperty(this.ctrl.events,function(b,c){ConsoleIO.removeEventListener(a.document.body,c,b)},this.ctrl)},ConsoleIO.View.Device.HTML.prototype.screenShot=function(a){if(this.dhxWins)if(a.screen){this.image.src=a.screen;var b=this.dhxWins.createWindow("screen",0,0,900,700);b.setText("Capture"),b.button("park").hide(),b.keepInViewport(!0),b.setModal(!0),b.centerOnScreen(),b.button("close").attachEvent("onClick",function(){b.detachObject(this.image),b.close()},this),b.attachObject(this.image)}else alert("Sorry!, Console.IO was unable to capture screen. Check console for more details.")},ConsoleIO.View.Device.HTML.prototype.setMode=function(a){if(a===ConsoleIO.Model.DHTMLX.ToolBarItem.Preview.id){var b=document.querySelector(".dhx_tabcontent_zone > [tab_id="+this.id+"]");!this.previewToolbar&&b&&(b.insertBefore(this.previewBar,document.querySelector(".dhx_tabcontent_zone > [tab_id="+this.id+"] [ida=dhxMainCont]")),this.previewToolbar=new dhtmlXToolbarObject(this.previewBar,ConsoleIO.Settings.theme),this.previewToolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.previewToolbar.attachEvent("onClick",function(a){this.onPreviewButtonClick(a,!0)},this.ctrl),this.previewToolbar.attachEvent("onStateChange",function(a,b){this.onPreviewButtonClick(a,b)},this.ctrl),this.previewToolbar.attachEvent("onEnter",function(a,b){ConsoleIO.Settings.triggerInterval=b},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.previewToolbar,this.previewToolbar),this.previewBar.className="dhx_toolbar_base_18_dhx_skyblue in_tabbarcell")}else this.previewToolbar&&(this.previewToolbar.unload(),this.previewToolbar=null,this.previewBar.parentNode.removeChild(this.previewBar))},ConsoleIO.View.Device.HTML.prototype.setTabActive=function(){this.target.setTabActive(this.id)},ConsoleIO.View.Device.HTML.prototype.setItemState=function(a,b){if(this.toolbar){var c=ConsoleIO.Model.DHTMLX.ToolBarItem[a];c&&this.toolbar.setItemState(c.id,b)}},ConsoleIO.namespace("ConsoleIO.View.Device.Profile"),ConsoleIO.View.Device.Profile=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.tab=null,this.toolbar=null,this.layout=null,this.listCell=null,this.list=null,this.treeCell=null,this.treeToolbar=null,this.tree=null,this.gridCell=null,this.grid=null,this.id=[this.model.name,this.model.serialNumber].join("-")},ConsoleIO.View.Device.Profile.prototype.render=function(a){this.target=a,this.target.addTab(this.id,this.model.name),this.tab=this.target.cells(this.id),this.toolbar=this.tab.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.toolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar),this.layout=this.tab.attachLayout("3W"),this.layout.setEffect("resize",!0),this.listCell=this.layout.cells(this.model.list.context),this.listCell.setText(this.model.list.title),this.listCell.setWidth(this.model.list.width),this.list=this.listCell.attachTree(),this.list.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("tree")),this.list.setIconPath(ConsoleIO.Settings.iconPath),this.list.enableHighlighting(!0),this.list.enableTreeImages(!0),this.list.enableTreeLines(!0),this.list.enableIEImageFix(!0),this.list.attachEvent("onClick",function(a){this.onListClick(a)},this.ctrl),this.treeCell=this.layout.cells(this.model.tree.context),this.treeCell.setText(this.model.tree.title),this.treeCell.setWidth(this.model.tree.width),this.treeToolbar=this.treeCell.attachToolbar(),this.treeToolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.treeToolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.treeToolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.tree.toolbar,this.treeToolbar),this.tree=this.treeCell.attachTree(),this.tree.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("tree")),this.tree.setIconPath(ConsoleIO.Settings.iconPath),this.tree.enableHighlighting(!0),this.tree.enableTreeImages(!0),this.tree.enableTreeLines(!0),this.tree.enableIEImageFix(!0),this.tree.attachEvent("onOpenEnd",function(a,b){return this.onTreeOpenEnd(a,b),!0},this.ctrl),this.gridCell=this.layout.cells(this.model.grid.context),this.gridCell.setText(this.model.grid.title),this.grid=this.gridCell.attachGrid(),this.grid.setIconsPath(ConsoleIO.Settings.iconPath),this.grid.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("grid")),this.grid.setHeader("Self,Total,Count,Function,Url"),this.grid.setInitWidthsP("10,10,10,50,20"),this.grid.setColAlign("right,right,right,left,right"),this.grid.setColTypes("ro,ro,ro,ro,ro"),this.grid.setColSorting("int,int,int,str,str"),this.grid.setSkin(ConsoleIO.Constant.THEMES.get("win")),this.grid.init()},ConsoleIO.View.Device.Profile.prototype.destroy=function(){this.target.removeTab(this.id)},ConsoleIO.View.Device.Profile.prototype.show=function(){this.target.showTab(this.id)},ConsoleIO.View.Device.Profile.prototype.hide=function(){this.target.hideTab(this.id,!0)},ConsoleIO.View.Device.Profile.prototype.addToList=function(a,b,c){this.list.insertNewItem(0,a,b,0,c,c,c)},ConsoleIO.View.Device.Profile.prototype.addTreeItem=function(a,b,c,d){this.tree.insertNewItem(a,b,c,0,d,d,d)},ConsoleIO.View.Device.Profile.prototype.addGridItem=function(a){this.grid.addRow(a.id,[a.selfTime,a.totalTime,a.numberOfCalls,a.functionName,a.url])},ConsoleIO.View.Device.Profile.prototype.closeItem=function(a,b){b?this.tree.closeAllItems(a):this.tree.closeItem(a)},ConsoleIO.View.Device.Profile.prototype.deleteListItem=function(a){this.list.deleteItem(a)},ConsoleIO.View.Device.Profile.prototype.resetTree=function(){this.tree.deleteItem(this.tree.getItemIdByIndex(0,0))},ConsoleIO.View.Device.Profile.prototype.resetGrid=function(){this.grid.clearAll()},ConsoleIO.View.Device.Profile.prototype.setTabActive=function(){this.target.setTabActive(this.id)},ConsoleIO.View.Device.Profile.prototype.setTitle=function(a){this.treeCell.setText([this.model.tree.title,a||""].join(": "))},ConsoleIO.View.Device.Profile.prototype.setItemText=function(a,b){if(this.toolbar){var c=ConsoleIO.Model.DHTMLX.ToolBarItem[a];c&&this.toolbar.setItemText(c.id,b||c.text)}},ConsoleIO.View.Device.Profile.prototype.showItem=function(a){if(this.treeToolbar){var b=ConsoleIO.Model.DHTMLX.ToolBarItem[a];b&&this.treeToolbar.showItem(b.id)}},ConsoleIO.View.Device.Profile.prototype.hideItem=function(a){if(this.treeToolbar){var b=ConsoleIO.Model.DHTMLX.ToolBarItem[a];b&&this.treeToolbar.hideItem(b.id)}},ConsoleIO.namespace("ConsoleIO.View.Device.Source"),ConsoleIO.View.Device.Source=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.toolbar=null,this.layout=null,this.tab=null,this.id=[this.model.name,this.model.serialNumber].join("-")},ConsoleIO.View.Device.Source.prototype.render=function(a){this.target=a,this.target.addTab(this.id,this.model.name),this.tab=this.target.cells(this.id),this.layout=this.tab.attachLayout("2U"),this.toolbar=this.getContextById(this.ctrl.context.source).attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.toolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar)},ConsoleIO.View.Device.Source.prototype.destroy=function(){this.target.removeTab(this.id)},ConsoleIO.View.Device.Source.prototype.getContextById=function(a){return this.layout?this.layout.cells(a):null},ConsoleIO.View.Device.Source.prototype.setTabActive=function(){this.target.setTabActive(this.id)},ConsoleIO.View.Device.Source.prototype.setTitle=function(a,b){this.layout&&(this.layout.cells(a).setText(b),this.layout.setCollapsedText(a,b))},ConsoleIO.View.Device.Source.prototype.setItemState=function(a,b){if(this.toolbar){var c=ConsoleIO.Model.DHTMLX.ToolBarItem[a];c&&this.toolbar.setItemState(c.id,b)
}},ConsoleIO.namespace("ConsoleIO.View.Device.Status"),ConsoleIO.View.Device.Status=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.toolbar=null,this.tab=null,this.accordion=null,this.id=[this.model.name,this.model.serialNumber].join("-"),this.grids={}},ConsoleIO.View.Device.Status.prototype.render=function(a){this.target=a,this.target.addTab(this.id,this.model.name),this.tab=this.target.cells(this.id),this.toolbar=this.tab.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.toolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),this.accordion=this.tab.attachAccordion(),this.accordion.setIconsPath(ConsoleIO.Settings.iconPath),this.accordion.attachEvent("onActive",function(a){this.setActive(a.replace(this.view.id+"-",""))},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar)},ConsoleIO.View.Device.Status.prototype.destroy=function(){this.target.removeTab(this.id)},ConsoleIO.View.Device.Status.prototype.clear=function(){if(this.accordion){ConsoleIO.forEachProperty(this.grids,function(a){a.destructor()},this),this.grids={};var a=this;this.accordion.forEachItem(function(b){a.accordion.removeItem(b.getId())})}},ConsoleIO.View.Device.Status.prototype.open=function(a){var b=this.id+"-"+a;this.accordion.cells(b)&&this.accordion.cells(b).open()},ConsoleIO.View.Device.Status.prototype.addLabel=function(a){var b,c=this.id+"-"+a;this.accordion.cells(c)||(this.accordion.addItem(c,a),this.grids[a]=b=this.accordion.cells(c).attachGrid(),b.setIconsPath(ConsoleIO.Settings.iconPath),b.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("grid")),b.setHeader("Name,Value"),b.setInitWidthsP("20,80"),b.setColAlign("right,left"),b.setColTypes("ro,ro"),b.setColSorting("str,str"),b.setSkin(ConsoleIO.Constant.THEMES.get("win")),b.init())},ConsoleIO.View.Device.Status.prototype.add=function(a,b,c){var d,e=this.grids[c];e&&("object"==typeof b?ConsoleIO.forEachProperty(b,function(b,c){d=this.getUniqueId(this.id,a),e.addRow(d,[a+"."+c,b]),e.setCellTextStyle(d,0,"font-weight:bold;")},this):(d=this.getUniqueId(this.id,a),e.addRow(d,[a,b]),e.setCellTextStyle(d,0,"font-weight:bold;")))},ConsoleIO.View.Device.Status.prototype.setTabActive=function(){this.target.setTabActive(this.id)},ConsoleIO.View.Device.Status.prototype.setItemState=function(a,b){this.toolbar&&this.toolbar.setItemState(a,b)},ConsoleIO.View.Device.Status.prototype.getUniqueId=function(){var a=0;return function(b,c){return[b,c,++a].join("-")}}(),ConsoleIO.View.Device.Status.prototype.getValue=function(a){return this.toolbar.getValue(a)},ConsoleIO.namespace("ConsoleIO.View.Editor"),ConsoleIO.View.Editor=function(a,b){this.ctrl=a,this.model=b,this.container=null,this.textArea=null,this.target=null,this.toolbar=null,this.createElements()},ConsoleIO.View.Editor.prototype.render=function(a){this.target=a,this.target.attachObject(this.container),this.model.toolbar&&(this.toolbar=this.target.attachToolbar(),this.toolbar.setIconsPath(ConsoleIO.Settings.iconPath),this.toolbar.attachEvent("onClick",function(a){this.onButtonClick(a)},this.ctrl),this.toolbar.attachEvent("onStateChange",function(a,b){this.onButtonClick(a,b)},this.ctrl),ConsoleIO.Service.DHTMLXHelper.populateToolbar(this.model.toolbar,this.toolbar))},ConsoleIO.View.Editor.prototype.destroy=function(){this.container.removeChild(this.textArea),this.container.parentNode.removeChild(this.container),this.toolbar&&this.toolbar.unload()},ConsoleIO.View.Editor.prototype.fileList=function(a){var b=this;this.toolbar.forEachListOption("open",function(a){b.toolbar.removeListOption("open",a)}),ConsoleIO.forEach(a,function(a,c){b.toolbar.addListOption("open","script-"+a,c,"button",a,ConsoleIO.Constant.ICONS.JAVASCRIPT)},this)},ConsoleIO.View.Editor.prototype.addScript=function(a){var b="script-"+a.name,c=this.toolbar.getAllListOptions("open").length;this.toolbar.removeListOption("open",b),this.toolbar.addListOption("open",b,c,"button",a.name,ConsoleIO.Constant.ICONS.JAVASCRIPT)},ConsoleIO.View.Editor.prototype.createElements=function(){this.container=ConsoleIO.Service.DHTMLXHelper.createElement({attr:{"class":"editor"},target:document.body}),this.textArea=ConsoleIO.Service.DHTMLXHelper.createElement({tag:"textarea",attr:{placeholder:this.model.placeholder},target:this.container})},ConsoleIO.View.Editor.prototype.show=function(){this.container.style.display="block",this.target.attachObject(this.container)},ConsoleIO.View.Editor.prototype.hide=function(){this.container.style.display="none",this.target.detachObject(this.container)},ConsoleIO.View.Editor.prototype.toggleButton=function(a,b){this.toolbar&&(b?this.toolbar.enableItem(a):this.toolbar.disableItem(a))},ConsoleIO.View.Editor.prototype.setItemText=function(a,b){if(this.toolbar){var c=ConsoleIO.Model.DHTMLX.ToolBarItem[a];c&&this.toolbar.setItemText(c.id,b||c.text)}},ConsoleIO.namespace("ConsoleIO.View.Manager"),ConsoleIO.View.Manager=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.tabs=null},ConsoleIO.View.Manager.prototype.render=function(a){this.target=a,this.tabs=this.target.attachTabbar(),this.tabs.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("tab")),this.tabs.enableTabCloseButton(!0),this.tabs.attachEvent("onTabClose",function(a){this.close(a)},this.ctrl),this.tabs.attachEvent("onTabClick",function(a){this.onTabClick(a)},this.ctrl)},ConsoleIO.View.Manager.prototype.add=function(a,b,c){this.tabs.addTab(a,b),c&&this.tabs.setTabActive(a)},ConsoleIO.View.Manager.prototype.update=function(a,b){this.tabs.setLabel(a,b)},ConsoleIO.View.Manager.prototype.remove=function(a){this.tabs.removeTab(a)},ConsoleIO.View.Manager.prototype.setActive=function(a){this.tabs.setTabActive(a)},ConsoleIO.View.Manager.prototype.getContextById=function(a){return this.tabs?this.tabs.cells(a):null},ConsoleIO.namespace("ConsoleIO.View.Server"),ConsoleIO.View.Server=function(a,b){this.ctrl=a,this.model=b,this.target=null,this.grid=null},ConsoleIO.View.Server.prototype.render=function(a){this.target=a,this.target.setWidth(this.model.width),this.target.setHeight(this.model.height),this.grid=this.target.attachGrid(),this.grid.setIconsPath(ConsoleIO.Settings.iconPath),this.grid.setImagePath(ConsoleIO.Constant.IMAGE_URL.get("grid")),this.grid.setHeader("Name,Value"),this.grid.setInitWidthsP("40,60"),this.grid.setColAlign("left,left"),this.grid.setColTypes("ro,ro"),this.grid.setColSorting("str,str"),this.grid.setSkin(ConsoleIO.Constant.THEMES.get("win")),this.grid.init()},ConsoleIO.View.Server.prototype.update=function(a){ConsoleIO.forEach(this.grid.getAllRowIds().split(","),function(a){this.grid.deleteRow(a)},this),ConsoleIO.forEachProperty(a,function(a,b){this.grid.addRow(b,[b,a]),this.grid.setCellTextStyle(b,0,"font-weight:bold;text-transform: capitalize;")},this)},ConsoleIO.namespace("ConsoleIO.App"),ConsoleIO.App=function(){this.context={browser:"a",editor:"b",server:"c",manager:"d"},this.view=new ConsoleIO.View.App(this,{target:document.body,type:"4U",status:"<a style='float:left;' target='_blank' href='http://nkashyap.github.io/console.io/'>Welcome to Console.IO</a><span style='float:right;'>Author: Nisheeth Kashyap, Email: nisheeth.k.kashyap@gmail.com</span>"}),this.browser=new ConsoleIO.App.Browser(this,{title:"Device List",contextId:"browser",width:200,height:250,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Refresh]}),this.editor=new ConsoleIO.App.Editor(this,{contextId:"editor",title:"Editor",placeholder:"Write javascript code to execute on remote client",codeMirror:{mode:"javascript",readOnly:!1},toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Execute,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Open,ConsoleIO.Model.DHTMLX.ToolBarItem.Save,ConsoleIO.Model.DHTMLX.ToolBarItem.Clear,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Cut,ConsoleIO.Model.DHTMLX.ToolBarItem.Copy,ConsoleIO.Model.DHTMLX.ToolBarItem.Paste,ConsoleIO.Model.DHTMLX.ToolBarItem.SelectAll,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Undo,ConsoleIO.Model.DHTMLX.ToolBarItem.Redo,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.WordWrap,ConsoleIO.extend(ConsoleIO.extend({},ConsoleIO.Model.DHTMLX.ToolBarItem.Beautify),{type:"button"})]}),this.server=new ConsoleIO.App.Server(this,{title:"Server",contextId:"server",width:200,height:250}),this.manager=new ConsoleIO.App.Manager(this,{title:"Manager",contextId:"manager"}),ConsoleIO.Service.Socket.on("user:fileList",this.fileList,this),ConsoleIO.Service.Socket.on("user:fileContent",this.fileContent,this),ConsoleIO.Service.Socket.on("user:fileSaved",this.fileSaved,this),ConsoleIO.Service.Socket.on("user:contentBeautified",this.contentBeautified,this)},ConsoleIO.App.prototype.render=function(){this.view.render(),this.browser.render(this.view.getContextById(this.context.browser)),this.editor.render(this.view.getContextById(this.context.editor)),this.server.render(this.view.getContextById(this.context.server)),this.manager.render(this.view.getContextById(this.context.manager))},ConsoleIO.App.prototype.fileList=function(a){this.editor.fileList(a)},ConsoleIO.App.prototype.fileSaved=function(a){this.editor.fileName=a.name,this.editor.addScript(a)},ConsoleIO.App.prototype.fileContent=function(a){this.editor.fileCanBeSaved=!1,this.editor.setValue(a)},ConsoleIO.App.prototype.contentBeautified=function(a){this.editor.fileCanBeSaved=!0,this.editor.setValue(a)},ConsoleIO.App.prototype.setTitle=function(a,b){this.view.setTitle(this.context[a],b)},ConsoleIO.App.prototype.getActiveDeviceSerialNumber=function(){return this.manager.getActiveDeviceSerialNumber()},ConsoleIO.namespace("ConsoleIO.App.Device"),ConsoleIO.App.Device=function(a,b){this.parent=a,this.model=b,this.activeTab=ConsoleIO.Settings.defaultTab,this.beautify=this.model.web.config.beautify||ConsoleIO.Model.DHTMLX.ToolBarItem.Beautify.pressed,this.wordWrap=ConsoleIO.Model.DHTMLX.ToolBarItem.WordWrap.pressed,this.console=new ConsoleIO.App.Device.Console(this,this.model),this.profile=new ConsoleIO.App.Device.Profile(this,this.model),this.source=new ConsoleIO.App.Device.Source(this,this.model),this.html=new ConsoleIO.App.Device.HTML(this,this.model),this.status=new ConsoleIO.App.Device.Status(this,this.model),this.view=new ConsoleIO.View.Device(this,this.model)},ConsoleIO.App.Device.prototype.render=function(a){this.view.render(a),this.status.render(this.view.tabs),this.source.render(this.view.tabs),this.html.render(this.view.tabs),this.profile.render(this.view.tabs),this.console.render(this.view.tabs);var b=this[this.activeTab];b&&b.setTabActive(),this.beautify&&this.setItemState("Beautify",this.beautify),this.wordWrap&&this.setItemState("WordWrap",this.wordWrap)},ConsoleIO.App.Device.prototype.destroy=function(){this.console=this.console.destroy(),this.profile=this.profile.destroy(),this.source=this.source.destroy(),this.html=this.html.destroy(),this.status=this.status.destroy(),this.view=this.view.destroy()},ConsoleIO.App.Device.prototype.update=function(a){this.parent.update(a)},ConsoleIO.App.Device.prototype.activate=function(a){a?this.activeTab&&this[this.activeTab].activate(a):(this.status.activate(a),this.source.activate(a),this.html.activate(a),this.profile.activate(a),this.console.activate(a))},ConsoleIO.App.Device.prototype.setItemState=function(a,b){this.source.setItemState(a,b),this.html.setItemState(a,b)},ConsoleIO.App.Device.prototype.onTabClick=function(a){this.activeTab&&this.activeTab===a||(this.activeTab&&this[this.activeTab].activate(!1),this.activeTab=a,this[this.activeTab].activate(!0))},ConsoleIO.App.Device.prototype.onButtonClick=function(a,b,c){var d=!1;switch(b){case"reload":ConsoleIO.Service.Socket.emit("reloadDevice",{serialNumber:this.model.serialNumber}),d=!0;break;case"refresh":a.refresh(),d=!0;break;case"beautify":this.setItemState("Beautify",this.beautify=c),d=!0,a.refresh();break;case"wordwrap":this.setItemState("WordWrap",this.wordWrap=c),a.editor.setOption("lineWrapping",c),d=!0;break;case"selectAll":a.editor.selectAll(),d=!0;break;case"copy":a.editor.copy(),d=!0}return d},ConsoleIO.namespace("ConsoleIO.App.Browser"),ConsoleIO.App.Browser=function(a,b){this.parent=a,this.model=b,this.store={platform:[],manufacture:[],browser:[],version:[],offline:[],subscribed:[]},this.nodes={processing:!1,closed:[]},this.view=new ConsoleIO.View.Browser(this,this.model),ConsoleIO.Service.Socket.on("user:registeredDevice",this.add,this),ConsoleIO.Service.Socket.on("user:subscribed",this.subscribed,this),ConsoleIO.Service.Socket.on("user:unSubscribed",this.unSubscribed,this),ConsoleIO.Service.Socket.on("device:registered",this.add,this),ConsoleIO.Service.Socket.on("device:online",this.online,this),ConsoleIO.Service.Socket.on("device:offline",this.offline,this)},ConsoleIO.App.Browser.prototype.render=function(a){this.parent.setTitle(this.model.contextId||this.model.serialNumber,this.model.title),this.view.render(a)},ConsoleIO.App.Browser.prototype.online=function(a){var b=this.store.offline.indexOf(a.serialNumber);b>-1&&this.store.offline.splice(b,1),this.isSubscribed(a.serialNumber)?this.subscribed(a):this.view.setIcon(a.serialNumber,ConsoleIO.Constant.ICONS.ONLINE)},ConsoleIO.App.Browser.prototype.offline=function(a){-1===this.store.offline.indexOf(a.serialNumber)&&this.store.offline.push(a.serialNumber),this.view.setIcon(a.serialNumber,ConsoleIO.Constant.ICONS.OFFLINE)},ConsoleIO.App.Browser.prototype.subscribe=function(a){this.isSubscribed(a)||ConsoleIO.Service.Socket.emit("subscribe",a)},ConsoleIO.App.Browser.prototype.subscribed=function(a){this.isSubscribed(a.serialNumber)||this.store.subscribed.push(a.serialNumber),this.view.setIcon(a.serialNumber,ConsoleIO.Constant.ICONS.SUBSCRIBE)},ConsoleIO.App.Browser.prototype.unSubscribed=function(a){var b=this.store.subscribed.indexOf(a.serialNumber);b>-1&&(this.store.subscribed.splice(b,1),-1===this.store.offline.indexOf(a.serialNumber)?this.online(a):this.offline(a))},ConsoleIO.App.Browser.prototype.add=function(a){var b=a.platform+"-"+a.manufacture,c=b+"-"+a.browser,d=c+"-"+a.version;-1===this.store.platform.indexOf(a.platform)&&(this.store.platform.push(a.platform),this.view.add(a.platform,a.platform,0,ConsoleIO.Constant.ICONS[a.platform.toUpperCase()]||ConsoleIO.Constant.ICONS.UNKNOWN)),-1===this.store.manufacture.indexOf(b)&&(this.store.manufacture.push(b),this.view.add(b,a.manufacture,a.platform,ConsoleIO.Constant.ICONS[a.manufacture.toUpperCase()]||ConsoleIO.Constant.ICONS.UNKNOWN)),-1===this.store.browser.indexOf(c)&&(this.store.browser.push(c),this.view.add(c,a.browser,b,ConsoleIO.Constant.ICONS[a.browser.toUpperCase()]||ConsoleIO.Constant.ICONS.UNKNOWN)),-1===this.store.version.indexOf(d)&&(this.store.version.push(d),this.view.add(d,a.version,c,ConsoleIO.Constant.ICONS.VERSION)),this.view.addOrUpdate(a.serialNumber,a.name.indexOf("|")>-1?a.browser:a.name,d),this.nodes.processing=!0,ConsoleIO.forEach([].concat(this.store.platform,this.store.manufacture,this.store.browser,this.store.version),function(a){this.nodes.closed.indexOf(a)>-1&&this.view.closeItem(a)},this),ConsoleIO.async(function(){this.nodes.processing=!1},this),a.subscribed&&a.online?this.subscribed(a):a.online?this.online(a):this.offline(a)},ConsoleIO.App.Browser.prototype.openNode=function(a,b){if(!this.nodes.processing){var c=this.nodes.closed.indexOf(a);-1===b&&-1===c?this.nodes.closed.push(a):c>-1&&this.nodes.closed.splice(c,1)}},ConsoleIO.App.Browser.prototype.clear=function(){ConsoleIO.forEach(this.store.platform,function(a){this.deleteItem(a)},this.view),this.store={platform:[],manufacture:[],browser:[],version:[],offline:[],subscribed:[]}},ConsoleIO.App.Browser.prototype.refresh=function(){this.clear(),ConsoleIO.Service.Socket.emit("refreshRegisteredDeviceList")},ConsoleIO.App.Browser.prototype.isSubscribed=function(a){return this.store.subscribed.indexOf(a)>-1},ConsoleIO.App.Browser.prototype.onButtonClick=function(a){"refresh"===a&&this.refresh()},ConsoleIO.namespace("ConsoleIO.App.Device.Console"),ConsoleIO.App.Device.Console=function(a,b){this.parent=a,this.model=b,this.active=!0,this.paused=!1,this.filters=[],this.searchRegex=null,this.store={added:[],queue:[]};var c=this.model.web.config;"undefined"!=typeof c.pageSize&&(ConsoleIO.Settings.pageSize.active=c.pageSize),"undefined"!=typeof c.paused&&(this.paused=this.model.web.config.paused),"undefined"!=typeof c.filters&&(this.filters=this.model.web.config.filters),"undefined"!=typeof c.search&&(this.searchRegex=this.model.web.config.search),this.view=new ConsoleIO.View.Device.Console(this,{name:"Console",serialNumber:this.model.serialNumber,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Reload,ConsoleIO.Model.DHTMLX.ToolBarItem.PlayPause,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Clear,ConsoleIO.Model.DHTMLX.ToolBarItem.Export,ConsoleIO.Model.DHTMLX.ToolBarItem.PageSize,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.SearchText,ConsoleIO.Model.DHTMLX.ToolBarItem.Search,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.FilterLabel,ConsoleIO.Model.DHTMLX.ToolBarItem.Log,ConsoleIO.Model.DHTMLX.ToolBarItem.Info,ConsoleIO.Model.DHTMLX.ToolBarItem.Debug,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Warn,ConsoleIO.Model.DHTMLX.ToolBarItem.Trace,ConsoleIO.Model.DHTMLX.ToolBarItem.Error]}),ConsoleIO.Service.Socket.on("device:console:"+this.model.serialNumber,this.add,this)},ConsoleIO.App.Device.Console.prototype.render=function(a){this.view.render(a),this.view.setItemState("playPause",this.paused),this.view.setValue("searchText",this.searchRegex),this.searchRegex&&this.applySearch(this.searchRegex),ConsoleIO.forEach(this.filters,function(a){this.view.setItemState("filter-"+a,!0)},this)},ConsoleIO.App.Device.Console.prototype.destroy=function(){ConsoleIO.Service.Socket.off("device:console:"+this.model.serialNumber,this.add,this),this.view=this.view.destroy()},ConsoleIO.App.Device.Console.prototype.activate=function(a){this.active=a,this.addBatch()},ConsoleIO.App.Device.Console.prototype.add=function(a){if(this.active&&!this.paused){if(this.store.added.push(a),!this.isFiltered(a)||!this.isSearchFiltered(a))return!1;this.view.add(a)}else this.store.queue.push(a)},ConsoleIO.App.Device.Console.prototype.addBatch=function(){this.active&&!this.paused&&(this.view.addBatch(this.getData(this.store.queue)),this.store.added=this.store.added.concat(this.store.queue),this.store.queue=[])},ConsoleIO.App.Device.Console.prototype.applySearch=function(a){this.searchRegex="undefined"==typeof a?this.view.getValue("searchText"):a,this.searchRegex&&(this.searchRegex="\\"!==this.searchRegex[0]?new RegExp("\\b"+this.searchRegex,"img"):new RegExp(this.searchRegex,"img")),this.view.clear(),this.view.addBatch(this.getData(this.store.added))},ConsoleIO.App.Device.Console.prototype.notify=function(a){ConsoleIO.Service.Socket.emit("webControl",{serialNumber:this.model.serialNumber,pageSize:ConsoleIO.Settings.pageSize.active,filters:this.filters,search:this.view.getValue("searchText"),paused:this.paused,clear:!!a})},ConsoleIO.App.Device.Console.prototype.isSearchFiltered=function(a){return this.searchRegex?a.message.search(this.searchRegex)>-1:!0},ConsoleIO.App.Device.Console.prototype.isFiltered=function(a){return 0===this.filters.length||this.filters.length>0&&this.filters.indexOf(a.type)>-1},ConsoleIO.App.Device.Console.prototype.setTabActive=function(){this.view.setTabActive()},ConsoleIO.App.Device.Console.prototype.getData=function(a){var b=0,c=[];return a.length>0&&ConsoleIO.every([].concat(a).reverse(),function(a){return this.isFiltered(a)&&this.isSearchFiltered(a)&&(c.push(a),b++),ConsoleIO.Settings.pageSize.active>b},this),c},ConsoleIO.App.Device.Console.prototype.onPageSizeChanged=function(a){ConsoleIO.Settings.pageSize.active=a.split("-")[1],this.view.clear(),this.view.addBatch(this.getData(this.store.added))},ConsoleIO.App.Device.Console.prototype.onFilterChanged=function(a,b){var c=a.split("-")[1],d=this.filters.indexOf(c);b&&-1===d?this.filters.push(c):d>-1&&this.filters.splice(d,1),this.view.clear(),this.view.addBatch(this.getData(this.store.added))},ConsoleIO.App.Device.Console.prototype.onButtonClick=function(a,b){if(!this.parent.onButtonClick(this,a,b))if(0===a.indexOf("pagesize-"))this.onPageSizeChanged(a),this.notify();else if(0===a.indexOf("filter-"))this.onFilterChanged(a,b),this.notify();else switch(a){case"playPause":this.paused=b,this.addBatch(),this.notify();break;case"clear":this.view.clear(),this.store.added=[],this.notify(!0);break;case"search":this.applySearch(),this.notify();break;case"export":ConsoleIO.Service.Socket.emit("exportLog",{serialNumber:this.model.serialNumber,name:this.model.name,content:this.view.getHTML()});break;default:this.parent.parent.parent.server.update({status:"Unhandled event",btnId:a,state:b})}},ConsoleIO.namespace("ConsoleIO.App.Device.Explorer"),ConsoleIO.App.Device.Explorer=function(a,b){this.parent=a,this.model=b,this.store={folder:[],files:[]},this.nodes={processing:!1,opened:[]},this.view=new ConsoleIO.View.Device.Explorer(this,this.model),ConsoleIO.Service.Socket.on("device:files:"+this.model.serialNumber,this.add,this),ConsoleIO.Service.Socket.on("device:download:"+this.model.serialNumber,this.download,this)},ConsoleIO.App.Device.Explorer.prototype.render=function(a){this.parent.setTitle(this.model.contextId||this.model.serialNumber,this.model.title),this.view.render(a)},ConsoleIO.App.Device.Explorer.prototype.destroy=function(){ConsoleIO.Service.Socket.off("device:files:"+this.model.serialNumber,this.add,this),ConsoleIO.Service.Socket.off("device:download:"+this.model.serialNumber,this.download,this),this.clear(),this.view=this.view.destroy()},ConsoleIO.App.Device.Explorer.prototype.add=function(a){ConsoleIO.forEach(a.files,function(a){a=a.split("?")[0];var b=new RegExp("((http|https)://)?([^/]+)","img"),c=a.match(b);ConsoleIO.forEach(c,function(a){var b=a.indexOf(".js")>-1,d=a.indexOf(".css")>-1,e=a.indexOf("http")>-1,f=this.getParentId(c,a),g=f?f+"|"+a:a;b||d?-1===this.store.files.indexOf(g)&&(this.store.files.push(g),this.view.add(g,a,f,ConsoleIO.Constant.ICONS[b?"JAVASCRIPT":d?"STYLESHEET":"FILE"])):-1===this.store.folder.indexOf(g)&&(this.store.folder.push(g),this.view.add(g,a,f,ConsoleIO.Constant.ICONS[e?"WEB":"FOLDEROPEN"]))},this)},this),this.nodes.processing=!0,ConsoleIO.forEach(this.store.folder,function(a){-1===this.nodes.opened.indexOf(a)&&this.view.closeItem(a)},this),ConsoleIO.async(function(){this.nodes.processing=!1},this)},ConsoleIO.App.Device.Explorer.prototype.download=function(a){this.exportFrame||(this.exportFrame=ConsoleIO.Service.DHTMLXHelper.createElement({tag:"iframe",target:document.body})),this.exportFrame.src=a.file},ConsoleIO.App.Device.Explorer.prototype.clear=function(){ConsoleIO.forEach(this.store.folder,function(a){this.deleteItem(a)},this.view),ConsoleIO.forEach(this.store.files,function(a){this.deleteItem(a)},this.view),this.store={folder:[],files:[]}},ConsoleIO.App.Device.Explorer.prototype.refresh=function(){this.clear(),ConsoleIO.Service.Socket.emit("reloadFiles",{serialNumber:this.model.serialNumber})},ConsoleIO.App.Device.Explorer.prototype.exports=function(){var a=this.view.getSelectedId();return this.store.folder.indexOf(a)>-1?(alert("Please select a file to download"),!1):void(this.store.files.indexOf(a)>-1&&ConsoleIO.Service.Socket.emit("fileSource",{serialNumber:this.model.serialNumber,saveFile:!0,url:(-1===a.indexOf("http")?"/":"")+a.replace(/[|]/gim,"/")}))},ConsoleIO.App.Device.Explorer.prototype.getParentId=function(a,b){var c=a.indexOf(b);return c>0?a.slice(0,c).join("|"):0},ConsoleIO.App.Device.Explorer.prototype.onButtonClick=function(a){switch("refresh"===a&&this.refresh(),a){case"refresh":this.refresh();break;case"export":this.exports()}},ConsoleIO.App.Device.Explorer.prototype.onDblClick=function(a){ConsoleIO.Service.Socket.emit("fileSource",{serialNumber:this.model.serialNumber,url:(-1===a.indexOf("http")?"/":"")+a.replace(/[|]/gim,"/")})},ConsoleIO.App.Device.Explorer.prototype.onOpenEnd=function(a,b){if(!this.nodes.processing){var c=this.nodes.opened.indexOf(a);1===b&&-1===c?this.nodes.opened.push(a):c>-1&&this.nodes.opened.splice(c,1)}},ConsoleIO.namespace("ConsoleIO.App.Device.HTML"),ConsoleIO.App.Device.HTML=function(a,b){var c=ConsoleIO.Model.DHTMLX.ToolBarItem;this.parent=a,this.model=b,this.view=new ConsoleIO.View.Device.HTML(this,{name:"HTML",serialNumber:this.model.serialNumber,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Refresh,ConsoleIO.Model.DHTMLX.ToolBarItem.Reload,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Source,ConsoleIO.Model.DHTMLX.ToolBarItem.Preview,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.WordWrap,ConsoleIO.Model.DHTMLX.ToolBarItem.Beautify,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.SelectAll,ConsoleIO.Model.DHTMLX.ToolBarItem.Copy,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.ScreenShot],previewToolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.TriggerLabel,ConsoleIO.Model.DHTMLX.ToolBarItem.TriggerInterval,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Click,ConsoleIO.Model.DHTMLX.ToolBarItem.DblClick,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.KeyPress,ConsoleIO.Model.DHTMLX.ToolBarItem.KeyDown,ConsoleIO.Model.DHTMLX.ToolBarItem.KeyUp,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.MouseMove,ConsoleIO.Model.DHTMLX.ToolBarItem.MouseOver,ConsoleIO.Model.DHTMLX.ToolBarItem.MouseOut,ConsoleIO.Model.DHTMLX.ToolBarItem.MouseEnter,ConsoleIO.Model.DHTMLX.ToolBarItem.MouseLeave]}),this.editor=new ConsoleIO.App.Editor(this,{}),this.activeMode=c.Source.pressed?c.Source.id:c.Preview.id,this.events={},ConsoleIO.Service.Socket.on("device:htmlDocument:"+this.model.serialNumber,this.addContent,this),ConsoleIO.Service.Socket.on("device:htmlContent:"+this.model.serialNumber,this.addContent,this),ConsoleIO.Service.Socket.on("device:screenShot:"+this.model.serialNumber,this.screenShot,this)},ConsoleIO.App.Device.HTML.prototype.render=function(a){this.view.render(a),this.editor.render(this.view.tab),this.switchMode(this.activeMode)},ConsoleIO.App.Device.HTML.prototype.destroy=function(){ConsoleIO.Service.Socket.off("device:htmlDocument:"+this.model.serialNumber,this.addContent,this),ConsoleIO.Service.Socket.off("device:htmlContent:"+this.model.serialNumber,this.addContent,this),ConsoleIO.Service.Socket.off("device:screenShot:"+this.model.serialNumber,this.screenShot,this),this.editor=this.editor.destroy(),this.view=this.view.destroy()},ConsoleIO.App.Device.HTML.prototype.activate=function(a){a&&ConsoleIO.Settings.reloadTabContentWhenActivated&&(this.editor.setOption("lineWrapping",this.parent.wordWrap),this.refresh())},ConsoleIO.App.Device.HTML.prototype.addContent=function(a){this.activeMode===ConsoleIO.Model.DHTMLX.ToolBarItem.Source.id?this.editor.setValue(a):this.view.preview(a)},ConsoleIO.App.Device.HTML.prototype.buildSelector=function(a,b){if("body"===a.tagName.toLowerCase())return b||"body";b=b?" "+b:"";var c=a.tagName;if(a.id)return c=c+"#"+a.id,c+b;if(a.parentElement.childElementCount>1){for(var d=1,e=a.previousElementSibling;e;)d++,e=e.previousElementSibling;c+=":nth-child("+d+")"}return this.buildSelector(a.parentElement,c+b)},ConsoleIO.App.Device.HTML.prototype.screenShot=function(a){this.view.toggleButton("ScreenShot",!0),this.view.screenShot(a)},ConsoleIO.App.Device.HTML.prototype.sendEvent=function(a){if(this.intervals=this.intervals||{},!this.intervals[a.type]){var b=this.buildSelector(a.srcElement),c={serialNumber:this.model.serialNumber,constructor:a.constructor.name};b&&(ConsoleIO.forEachProperty(a,function(d,e){if(a.hasOwnProperty(e))if("object"!=typeof d)c[e]=d;else if("srcElement"===e)c.srcElement="$!"+b;else if(null!==d&&"object"==typeof d&&d.tagName){var f=this.buildSelector(d);f&&(c[e]="$!"+f)}},this),ConsoleIO.Service.Socket.emit("remoteEvent",c)),this.intervals[a.type]=ConsoleIO.async(function(){window.clearTimeout(this.intervals[a.type]),delete this.intervals[a.type]},this,ConsoleIO.Settings.triggerInterval)}},ConsoleIO.App.Device.HTML.prototype.refresh=function(){this.activeMode===ConsoleIO.Model.DHTMLX.ToolBarItem.Source.id?ConsoleIO.Service.Socket.emit("htmlSource",{serialNumber:this.model.serialNumber,beautify:this.parent.beautify}):ConsoleIO.Service.Socket.emit("htmlPreview",{serialNumber:this.model.serialNumber})},ConsoleIO.App.Device.HTML.prototype.switchMode=function(a){this.activeMode=a,this.setItemState("Preview","preview"===a),this.setItemState("Source","source"===a),this.view.toggleButton("WordWrap","source"===a),this.view.toggleButton("Beautify","source"===a),this.view.toggleButton("SelectAll","source"===a),this.view.toggleButton("Copy","source"===a),this.activeMode===ConsoleIO.Model.DHTMLX.ToolBarItem.Source.id?(this.view.hide(),this.editor.show()):(this.editor.hide(),this.view.show()),this.view.setMode(this.activeMode),this.refresh()},ConsoleIO.App.Device.HTML.prototype.setTabActive=function(){this.view.setTabActive()},ConsoleIO.App.Device.HTML.prototype.setItemState=function(a,b){this.view.setItemState(a,b)},ConsoleIO.App.Device.HTML.prototype.onPreviewButtonClick=function(a,b){var c=this,d=ConsoleIO.Model.DHTMLX.ToolBarItem[a];d&&(d.pressed=b),a=a.toLowerCase(),this.view.unbind(),b?this.events[a]||(this.events[a]=function(a){c.sendEvent(a)}):delete this.events[a],this.view.bind()},ConsoleIO.App.Device.HTML.prototype.onButtonClick=function(a,b){if(!this.parent.onButtonClick(this,a,b))switch(a){case"source":case"preview":this.switchMode(a);break;case"screenShot":this.view.toggleButton("ScreenShot",!1),ConsoleIO.Service.Socket.emit("captureScreen",{serialNumber:this.model.serialNumber}),ConsoleIO.async(function(){this.view.toggleButton("ScreenShot",!0)},this,1e4);break;default:this.parent.parent.parent.server.update({status:"Unhandled event",btnId:a,state:b})}},ConsoleIO.namespace("ConsoleIO.App.Device.Profile"),ConsoleIO.App.Device.Profile=function(a,b){this.parent=a,this.model=b,this.profiles={},this.activeProfile=null,this.openNodes=[],this.view=new ConsoleIO.View.Device.Profile(this,{name:"Profile",serialNumber:this.model.serialNumber,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Reload,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.Profiler,ConsoleIO.Model.DHTMLX.ToolBarItem.Clear],list:{context:"a",title:"Profiles",width:120},tree:{context:"b",title:"Active Profile",width:350,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.ProfileView,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.TimeOrPercent,ConsoleIO.Model.DHTMLX.ToolBarItem.FocusFn,ConsoleIO.Model.DHTMLX.ToolBarItem.RestoreFn,ConsoleIO.Model.DHTMLX.ToolBarItem.ExcludeFn]},grid:{context:"c",title:"Summary"}}),ConsoleIO.Service.Socket.on("device:profile:"+this.model.serialNumber,this.addProfile,this),ConsoleIO.Service.Socket.on("device:online:"+this.model.serialNumber,this.syncConfig,this)},ConsoleIO.App.Device.Profile.prototype.render=function(a){this.view.render(a),ConsoleIO.async(function(){this.syncConfig(this.model)},this)},ConsoleIO.App.Device.Profile.prototype.destroy=function(){ConsoleIO.Service.Socket.off("device:profile:"+this.model.serialNumber,this.addProfile,this),ConsoleIO.Service.Socket.off("device:online:"+this.model.serialNumber,this.syncConfig,this),this.view=this.view.destroy()},ConsoleIO.App.Device.Profile.prototype.syncConfig=function(a){a.serialNumber===this.model.serialNumber&&(this.model=a,a.web.config.profile&&"false"!==a.web.config.profile?this.view.show():this.view.hide())},ConsoleIO.App.Device.Profile.prototype.clear=function(){ConsoleIO.forEach(ConsoleIO.keys(this.profiles),function(a){this.view.deleteListItem(a)
},this),this.view.resetTree(),this.view.resetGrid(),this.view.setTitle(),this.profiles={},this.openNodes=[],this.activeProfile=null},ConsoleIO.App.Device.Profile.prototype.addProfile=function(a){this.profiles[a.uid]&&(a.uid=ConsoleIO.getUniqueId()),this.profiles[a.uid]=a,this.view.addToList(a.uid,a.title,ConsoleIO.Constant.ICONS.PROFILE)},ConsoleIO.App.Device.Profile.prototype.addTreeNodes=function(a,b){this.view.addTreeItem(b,a.id,a.functionName||a.id,ConsoleIO.Constant.ICONS.FUNCTIONS),a.children.length>0&&ConsoleIO.forEach(a.children,function(b){this.addTreeNodes(b,a.id)},this)},ConsoleIO.App.Device.Profile.prototype.addGridRows=function(a,b){var c=b.indexOf(a.id);this.view.addGridItem(this.toDate(a)),c>-1&&b.splice(c,1),a.children.length>0&&ConsoleIO.forEach(a.children,function(a){b.indexOf(a.id)>-1?this.addGridRows(a,b):this.view.addGridItem(this.toDate(a))},this)},ConsoleIO.App.Device.Profile.prototype.toDate=function(a){var b={id:a.id,functionName:a.functionName||a.id,selfTime:this.parseTime(a.selfTime),totalTime:this.parseTime(a.totalTime),numberOfCalls:a.numberOfCalls};return a.url&&(b.url="<a target='_blank' href='"+a.url+"' >"+a.url.substring(a.url.lastIndexOf("/")+1)+":"+a.lineNumber+"</a>"),b},ConsoleIO.App.Device.Profile.prototype.parseTime=function(a){return a/1e3+" ms"},ConsoleIO.App.Device.Profile.prototype.activate=function(){},ConsoleIO.App.Device.Profile.prototype.setTabActive=function(){this.view.setTabActive()},ConsoleIO.App.Device.Profile.prototype.onTreeOpenEnd=function(a,b){var c=this.openNodes.indexOf(a);this.view.resetGrid(),1===b&&-1===c?this.openNodes.push(a):-1===b&&c>-1&&this.openNodes.splice(c,1),ConsoleIO.async(function(){this.addGridRows(this.profiles[this.activeProfile].head,[].concat(this.openNodes))},this)},ConsoleIO.App.Device.Profile.prototype.onListClick=function(a){this.view.resetTree(),this.view.resetGrid(),this.activeProfile=a,this.openNodes=[];var b=this.profiles[a];this.view.setTitle(b.title),ConsoleIO.async(function(){this.addTreeNodes(b.head,0),this.view.closeItem(0,!0)},this)},ConsoleIO.App.Device.Profile.prototype.onButtonClick=function(a,b){if(!this.parent.onButtonClick(this,a,b))switch(a){case"profiler":ConsoleIO.Service.Socket.emit("profiler",{serialNumber:this.model.serialNumber,state:b}),b?this.view.setItemText("Profiler","Stop Profiling"):this.view.setItemText("Profiler");break;case"clear":this.clear();break;default:console.log(a,b)}},ConsoleIO.namespace("ConsoleIO.App.Device.Source"),ConsoleIO.App.Device.Source=function(a,b){this.parent=a,this.model=b,this.url=null,this.context={explorer:"a",source:"b"},this.view=new ConsoleIO.View.Device.Source(this,{name:"Source",serialNumber:this.model.serialNumber,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Refresh,ConsoleIO.Model.DHTMLX.ToolBarItem.Reload,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.WordWrap,ConsoleIO.Model.DHTMLX.ToolBarItem.Beautify,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.SelectAll,ConsoleIO.Model.DHTMLX.ToolBarItem.Copy]}),this.explorer=new ConsoleIO.App.Device.Explorer(this,{name:this.model.name,serialNumber:this.model.serialNumber,title:"Files",contextId:"explorer",width:200,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Refresh,ConsoleIO.Model.DHTMLX.ToolBarItem.Export]}),this.editor=new ConsoleIO.App.Editor(this,{codeMirror:{mode:"javascript"},title:"Code",contextId:"source"}),ConsoleIO.Service.Socket.on("device:source:"+this.model.serialNumber,this.addContent,this)},ConsoleIO.App.Device.Source.prototype.render=function(a){this.view.render(a),this.explorer.render(this.view.getContextById(this.context.explorer)),this.editor.render(this.view.getContextById(this.context.source))},ConsoleIO.App.Device.Source.prototype.destroy=function(){ConsoleIO.Service.Socket.off("device:source:"+this.model.serialNumber,this.addContent,this),this.explorer=this.explorer.destroy(),this.editor=this.editor.destroy(),this.view=this.view.destroy()},ConsoleIO.App.Device.Source.prototype.activate=function(a){a&&ConsoleIO.Settings.reloadTabContentWhenActivated&&(this.editor.setOption("lineWrapping",this.parent.wordWrap),this.refresh(),this.explorer.refresh())},ConsoleIO.App.Device.Source.prototype.addContent=function(a){this.url=a.url,this.editor.setValue(a),this.setTitle("source",this.url)},ConsoleIO.App.Device.Source.prototype.refresh=function(){this.url&&ConsoleIO.Service.Socket.emit("fileSource",{serialNumber:this.model.serialNumber,url:this.url,beautify:this.parent.beautify})},ConsoleIO.App.Device.Source.prototype.setTabActive=function(){this.view.setTabActive()},ConsoleIO.App.Device.Source.prototype.setItemState=function(a,b){this.view.setItemState(a,b)},ConsoleIO.App.Device.Source.prototype.setTitle=function(a,b){this.view.setTitle(this.context[a],b)},ConsoleIO.App.Device.Source.prototype.onButtonClick=function(a,b){this.parent.onButtonClick(this,a,b)||this.parent.parent.parent.server.update({status:"Unhandled event",btnId:a,state:b})},ConsoleIO.namespace("ConsoleIO.App.Device.Status"),ConsoleIO.App.Device.Status=function(a,b){this.parent=a,this.model=b,this.activeAccordion=ConsoleIO.Settings.defaultAccordion,ConsoleIO.Model.DHTMLX.ToolBarItem.DeviceNameText.value=this.model.name,this.view=new ConsoleIO.View.Device.Status(this,{name:"Status",serialNumber:this.model.serialNumber,toolbar:[ConsoleIO.Model.DHTMLX.ToolBarItem.Refresh,ConsoleIO.Model.DHTMLX.ToolBarItem.Reload,ConsoleIO.Model.DHTMLX.ToolBarItem.Web,ConsoleIO.Model.DHTMLX.ToolBarItem.Separator,ConsoleIO.Model.DHTMLX.ToolBarItem.DeviceNameLabel,ConsoleIO.Model.DHTMLX.ToolBarItem.DeviceNameText,ConsoleIO.Model.DHTMLX.ToolBarItem.DeviceNameSet]}),ConsoleIO.Service.Socket.on("device:status:"+this.model.serialNumber,this.add,this),ConsoleIO.Service.Socket.on("device:web:status:"+this.model.serialNumber,this.web,this)},ConsoleIO.App.Device.Status.prototype.render=function(a){this.view.render(a),this.view.setItemState("web",this.model.web.enabled)},ConsoleIO.App.Device.Status.prototype.destroy=function(){ConsoleIO.Service.Socket.off("device:status:"+this.model.serialNumber,this.add,this),ConsoleIO.Service.Socket.off("device:web:status:"+this.model.serialNumber,this.web,this),this.view=this.view.destroy()},ConsoleIO.App.Device.Status.prototype.web=function(a){this.model.web.enabled=a.enabled,this.view.setItemState("web",a.enabled)},ConsoleIO.App.Device.Status.prototype.activate=function(a){a&&ConsoleIO.Settings.reloadTabContentWhenActivated&&this.refresh()},ConsoleIO.App.Device.Status.prototype.add=function(a){this.view.clear(),ConsoleIO.forEach(a.info,function(a){ConsoleIO.forEachProperty(a,function(a,b){this.view.addLabel(b),ConsoleIO.forEachProperty(a,function(a,c){switch(c.toLowerCase()){case"search":case"href":a=ConsoleIO.queryParams(a);break;case"cookie":a=ConsoleIO.cookieToJSON(a)}this.view.add(c,"string"==typeof a?a.replace(/"/gim,""):a,b)},this)},this)},this),this.view.open(this.activeAccordion)},ConsoleIO.App.Device.Status.prototype.refresh=function(){ConsoleIO.Service.Socket.emit("deviceStatus",{serialNumber:this.model.serialNumber})},ConsoleIO.App.Device.Status.prototype.setTabActive=function(){this.view.setTabActive()},ConsoleIO.App.Device.Status.prototype.setActive=function(a){this.activeAccordion=a},ConsoleIO.App.Device.Status.prototype.onButtonClick=function(a,b){if(!this.parent.onButtonClick(this,a,b))switch(a){case"deviceNameSet":var c=this.view.getValue("deviceNameText");c&&(ConsoleIO.Service.Socket.emit("deviceName",{serialNumber:this.model.serialNumber,name:c}),this.model.name=c,this.parent.update(this.model));break;case"web":this.model.web.enabled!==b&&(this.model.web.enabled=b,ConsoleIO.Service.Socket.emit("webConfig",{serialNumber:this.model.serialNumber,enabled:this.model.web.enabled}));break;default:this.parent.parent.parent.server.update({status:"Unhandled event",btnId:a,state:b})}},ConsoleIO.namespace("ConsoleIO.App.Editor"),ConsoleIO.namespace("ConsoleIO.App.Editor.CopyDocument"),ConsoleIO.App.Editor=function(a,b){var c=this;this.parent=a,this.model=b,this.model.codeMirror=ConsoleIO.extend({mode:{name:"htmlmixed",scriptTypes:[{matches:/\/x-handlebars-template|\/x-mustache/i,mode:null},{matches:/(text|application)\/(x-)?vb(a|script)/i,mode:"vbscript"}]},readOnly:!0,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,statementIndent:!0,lineWrapping:!1,styleActiveLine:!0,highlightSelectionMatches:!0,continueComments:"Enter",extraKeys:{"Ctrl-Space":"autocomplete","Ctrl-Enter":"submit","Ctrl-Q":"toggleComment","Shift-Ctrl-Q":function(a){c.foldCode(a.getCursor())}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]},this.model.codeMirror),this.fileName=null,this.fileCanBeSaved=!1,this.view=new ConsoleIO.View.Editor(this,{serialNumber:this.model.serialNumber,placeholder:this.model.placeholder,toolbar:this.model.toolbar})},ConsoleIO.App.Editor.prototype.render=function(a){this.setTitle(),this.editor=CodeMirror.fromTextArea(this.view.textArea,this.model.codeMirror),this.view.render(a);var b=this;this.editor.on("change",function(){b.fileName&&(b.fileCanBeSaved&&!b.getDoc().isClean()?b.setTitle(b.fileName,"UNSAVED"):(b.fileCanBeSaved=!0,b.setTitle(b.fileName),b.getDoc().markClean())),b.updateButtonState()})},ConsoleIO.App.Editor.prototype.destroy=function(){this.view=this.view.destroy()},ConsoleIO.App.Editor.prototype.foldCode=function(a){this.editor.foldCode(a,"javascript"===this.model.codeMirror.mode?CodeMirror.braceRangeFinder:CodeMirror.tagRangeFinder)},ConsoleIO.App.Editor.prototype.fileList=function(a){this.view.fileList(a)},ConsoleIO.App.Editor.prototype.addScript=function(a){this.view.addScript(a),this.setTitle(this.fileName,"SAVED"),this.fileCanBeSaved=!1},ConsoleIO.App.Editor.prototype.selectAll=function(){var a=this.getDoc();a.setSelection({line:0,ch:0},{line:a.lineCount(),ch:0})},ConsoleIO.App.Editor.prototype.copy=function(){ConsoleIO.App.Editor.CopyDocument=this.getDoc().getSelection(),this.updateButtonState()},ConsoleIO.App.Editor.prototype.cut=function(){this.copy(),this.editor.replaceSelection(""),this.updateButtonState()},ConsoleIO.App.Editor.prototype.paste=function(){var a=this.getDoc();ConsoleIO.App.Editor.CopyDocument&&(a.somethingSelected()?a.replaceSelection(ConsoleIO.App.Editor.CopyDocument):this.editor.setValue(this.editor.getValue()+ConsoleIO.App.Editor.CopyDocument),a.setCursor({line:a.lineCount(),ch:0})),this.updateButtonState()},ConsoleIO.App.Editor.prototype.undo=function(){this.editor.undo(),this.updateButtonState()},ConsoleIO.App.Editor.prototype.redo=function(){this.editor.redo(),this.updateButtonState()},ConsoleIO.App.Editor.prototype.clear=function(){this.fileName&&!this.getDoc().isClean()?confirm("File is not saved!\nAre you sure you want to close it?")&&this.close():this.close()},ConsoleIO.App.Editor.prototype.show=function(){this.view.show()},ConsoleIO.App.Editor.prototype.hide=function(){this.view.hide()},ConsoleIO.App.Editor.prototype.close=function(){this.fileName=null,this.editor.setValue(""),this.getDoc().markClean(),this.getDoc().clearHistory(),this.updateButtonState(),this.setTitle(),this.view.setItemText("Clear")},ConsoleIO.App.Editor.prototype.save=function(a){var b=null,c=this.editor.getValue();b=this.fileName?a?prompt("Save file as:",""):this.fileName:prompt("Enter a new file name:",""),null!==b&&ConsoleIO.Service.Socket.emit("writeFile",{content:c,name:b})},ConsoleIO.App.Editor.prototype.command=function(){var a=this.editor.getValue();a&&ConsoleIO.Service.Socket.emit("execute",{serialNumber:this.parent.getActiveDeviceSerialNumber(),code:"(function(){"+a+"}());"})},ConsoleIO.App.Editor.prototype.updateButtonState=function(){if(this.model.toolbar){var a=this.getDoc().historySize();this.view.toggleButton("undo",a.undo>0),this.view.toggleButton("redo",a.redo>0),this.fileName?this.view.toggleButton("save",this.fileCanBeSaved&&!this.getDoc().isClean()):this.view.toggleButton("save",!this.getDoc().isClean())}},ConsoleIO.App.Editor.prototype.setValue=function(a){a.name&&(this.fileName=a.name,this.setTitle(this.fileName),this.view.setItemText("Clear","Close"));var b,c=a.content.replace(/%20/gim," ");a.start&&0!==a.start?a.start>0&&(b=this.editor.lastLine(),this.editor.replaceRange(c,{line:b,ch:this.editor.getLine(b).length})):this.editor.setValue(c)},ConsoleIO.App.Editor.prototype.setTitle=function(){if(this.parent.setTitle){var a=[this.model.title].concat(ConsoleIO.toArray(arguments));this.parent.setTitle(this.model.contextId||this.model.serialNumber,a.join(" : "))}},ConsoleIO.App.Editor.prototype.setOption=function(a,b){this.editor.setOption(a,b)},ConsoleIO.App.Editor.prototype.getDoc=function(){return this.editor.getDoc()},ConsoleIO.App.Editor.prototype.onButtonClick=function(a,b){if(0===a.indexOf("script-"))return void ConsoleIO.Service.Socket.emit("readFile",{name:a.split("-")[1]});switch(a){case"beautify":ConsoleIO.Service.Socket.emit("beautify",{name:this.fileName||"",content:this.editor.getValue()});break;case"cut":this.cut();break;case"copy":this.copy();break;case"paste":this.paste();break;case"selectAll":this.selectAll();break;case"undo":this.undo();break;case"redo":this.redo();break;case"clear":this.clear();break;case"wordwrap":this.setOption("lineWrapping",b);break;case"execute":this.command();break;case"save":this.save(!1);break;case"saveAs":this.save(!0)}},ConsoleIO.namespace("ConsoleIO.App.Manager"),ConsoleIO.App.Manager=function(a,b){this.parent=a,this.model=b,this.activeTab=null,this.store={serialNumber:[],device:[]},this.exportFrame=null,this.view=new ConsoleIO.View.Manager(this,this.model),ConsoleIO.Service.Socket.on("user:subscribed",this.add,this),ConsoleIO.Service.Socket.on("user:unSubscribed",this.remove,this),ConsoleIO.Service.Socket.on("user:download",this.download,this)},ConsoleIO.App.Manager.prototype.render=function(a){this.parent.setTitle(this.model.contextId||this.model.serialNumber,this.model.title),this.view.render(a)},ConsoleIO.App.Manager.prototype.add=function(a){if(-1===this.store.serialNumber.indexOf(a.serialNumber)){this.store.serialNumber.push(a.serialNumber),this.view.add(a.serialNumber,a.name,this.store.serialNumber.length>0);var b=new ConsoleIO.App.Device(this,a);this.store.device.push(b),b.render(this.view.getContextById(a.serialNumber))}},ConsoleIO.App.Manager.prototype.update=function(a){this.store.serialNumber.indexOf(a.serialNumber)>-1&&this.view.update(a.serialNumber,a.name)},ConsoleIO.App.Manager.prototype.remove=function(a){var b=this.store.serialNumber.indexOf(a.serialNumber);b>-1&&(ConsoleIO.every(this.store.device,function(b,c){return b.model.serialNumber===a.serialNumber?(b=b.destroy(),this.store.device.splice(c,1),!1):!0},this),this.store.serialNumber.splice(b,1),this.view.remove(a.serialNumber),this.activeTab===a.serialNumber&&(this.activeTab=this.store.serialNumber[0],this.activeTab&&this.view.setActive(this.activeTab)))},ConsoleIO.App.Manager.prototype.removeAll=function(){ConsoleIO.forEach(this.store.device,function(a,b){a.destroy(),this.store.device.splice(b,1)},this),ConsoleIO.forEach(this.store.serialNumber,function(a,b){this.view.remove(a),this.store.serialNumber.splice(b,1)},this),this.activeTab=null},ConsoleIO.App.Manager.prototype.download=function(a){this.exportFrame||(this.exportFrame=ConsoleIO.Service.DHTMLXHelper.createElement({tag:"iframe",target:document.body})),this.exportFrame.src=a.file},ConsoleIO.App.Manager.prototype.close=function(a){ConsoleIO.Service.Socket.emit("unSubscribe",a)},ConsoleIO.App.Manager.prototype.getActiveDeviceSerialNumber=function(){return this.activeTab},ConsoleIO.App.Manager.prototype.getDevice=function(a){var b;return ConsoleIO.every(this.store.device,function(c){return c.model.serialNumber===a?(b=c,!1):!0},this),b},ConsoleIO.App.Manager.prototype.onTabClick=function(a){if(!this.activeTab||this.activeTab!==a){var b;this.activeTab&&(b=this.getDevice(this.activeTab),b&&b.activate(!1)),this.activeTab=a,b=this.getDevice(this.activeTab),b&&b.activate(!0)}},ConsoleIO.namespace("ConsoleIO.App.Server"),ConsoleIO.App.Server=function(a,b){this.parent=a,this.model=b,this.view=new ConsoleIO.View.Server(this,this.model),this.isReady=!1,ConsoleIO.Service.Socket.on("connect",this.onConnect,this),ConsoleIO.Service.Socket.on("connecting",this.onConnecting,this),ConsoleIO.Service.Socket.on("reconnect",this.onReconnect,this),ConsoleIO.Service.Socket.on("reconnecting",this.onReconnecting,this),ConsoleIO.Service.Socket.on("disconnect",this.onDisconnect,this),ConsoleIO.Service.Socket.on("connect_failed",this.onConnectFailed,this),ConsoleIO.Service.Socket.on("reconnect_failed",this.onReconnectFailed,this),ConsoleIO.Service.Socket.on("error",this.onError,this),ConsoleIO.Service.Socket.on("user:ready",this.onReady,this),ConsoleIO.Service.Socket.on("user:online",this.onOnline,this),ConsoleIO.Service.Socket.on("user:offline",this.onOffline,this),ConsoleIO.Service.Socket.on("user:disconnect",this.onUserDisconnect,this),ConsoleIO.Service.Socket.on("user:error",this.onUserError,this)},ConsoleIO.App.Server.prototype.render=function(a){this.parent.setTitle(this.model.contextId||this.model.serialNumber,this.model.title),this.view.render(a)},ConsoleIO.App.Server.prototype.update=function(a){a.mode||(a.mode=ConsoleIO.Service.Socket.connectionMode),this.view.update(a)},ConsoleIO.App.Server.prototype.onConnect=function(){this.update({status:"Connected"})},ConsoleIO.App.Server.prototype.onConnecting=function(a){this.update({status:"Connecting",mode:a})},ConsoleIO.App.Server.prototype.onReconnect=function(a,b){this.update({status:"Reconnected",mode:a,attempts:b})},ConsoleIO.App.Server.prototype.onReconnecting=function(a,b){this.update({status:"Reconnecting",timeout:a,attempts:b})},ConsoleIO.App.Server.prototype.onDisconnect=function(a){this.update({status:"Disconnected",reason:a})},ConsoleIO.App.Server.prototype.onConnectFailed=function(){this.update({status:"Connection failed",args:ConsoleIO.toArray(arguments).join(", ")})},ConsoleIO.App.Server.prototype.onReconnectFailed=function(){this.update({status:"Reconnection failed",args:ConsoleIO.toArray(arguments).join(", ")})},ConsoleIO.App.Server.prototype.onError=function(a){this.update({status:"Connection error",error:[a.type,a.message||""].join(", ")})},ConsoleIO.App.Server.prototype.onReady=function(a){this.isReady&&(this.parent.browser.clear(),this.parent.manager.removeAll()),this.isReady=!0,ConsoleIO.extend(ConsoleIO.Service.Socket,a),this.update({status:"Ready"})},ConsoleIO.App.Server.prototype.onOnline=function(a){this.isReady=!0,ConsoleIO.extend(ConsoleIO.Service.Socket,a),this.update({status:"Online"})},ConsoleIO.App.Server.prototype.onOffline=function(a){ConsoleIO.extend(ConsoleIO.Service.Socket,a),this.update({status:"Offline"})},ConsoleIO.App.Server.prototype.onUserDisconnect=function(a){ConsoleIO.extend(ConsoleIO.Service.Socket,a),this.update({status:"User disconnected"}),ConsoleIO.Service.Socket.forceReconnect()},ConsoleIO.App.Server.prototype.onUserError=function(a){this.update({status:"Server error",message:a.message})},ConsoleIO.namespace("ConsoleIO.Settings"),ConsoleIO.Settings={theme:"web",iconPath:"resources/icons/",reloadTabContentWhenActivated:!0,pageSize:{active:50,list:[50,100,250,500]},defaultTab:"console",defaultAccordion:"device",triggerInterval:1e3},ConsoleIO.namespace("ConsoleIO.Constant.THEMES"),ConsoleIO.namespace("ConsoleIO.Constant.IMAGE_URL"),ConsoleIO.namespace("ConsoleIO.Constant.ICONS"),ConsoleIO.Constant.THEMES={web:{layout:"dhx_skyblue",grid:"dhx_skyblue",win:"dhx_skyblue"},terrace:{layout:"dhx_terrace",grid:"dhx_terrace",win:"dhx_terrace"},get:function(a){return ConsoleIO.Constant.THEMES[ConsoleIO.Settings.theme][a]}},ConsoleIO.Constant.IMAGE_URL={web:{tree:"resources/lib/dhtmlx/web/imgs/csh_vista/",tab:"resources/lib/dhtmlx/web/imgs/",win:"resources/lib/dhtmlx/web/imgs/",grid:"resources/lib/dhtmlx/web/imgs/"},terrace:{tree:"resources/lib/dhtmlx/terrace/imgs/csh_dhx_terrace/",tab:"resources/lib/dhtmlx/terrace/imgs/",win:"resources/lib/dhtmlx/terrace/imgs/",grid:"resources/lib/dhtmlx/terrace/imgs/"},get:function(a){return ConsoleIO.Constant.IMAGE_URL[ConsoleIO.Settings.theme][a]}},ConsoleIO.Constant.ICONS={ONLINE:"online.png",OFFLINE:"offline.png",SUBSCRIBE:"subscribe.png",VERSION:"version.png",PC:"pc.png",TV:"tv.png",STB:"stb.png",MOBILE:"mobile.png",TABLET:"tablet.png",MEDIA:"media.png",BLUERAY:"blueray.png",CONSOLE:"playstation.png",LG:"lg.png",PHILIPS:"philips.png",SAMSUNG:"samsung.png",TOSHIBA:"toshiba.png",TESCO:"tesco.png",SONY:"sony.png",PANASONIC:"panasonic.png",MICROSOFT:"microsoft.png",MOZILLA:"mozilla.png",GOOGLE:"google.png",APPLE:"apple.png",ANDROID:"android.png","OPERA SOFTWARE":"opera.png",GINGERBREAD:"gingerbread.png",CHROME:"chrome.png",IE:"explorer.png",FIREFOX:"firefox.png",OPERA:"opera.png",SAFARI:"safari.png",MAPLE:"maple.png",NETTV:"nettv.png",NETCAST:"netcast.png",TOSHIBATP:"toshibatp.png",ESPIAL:"espial.png",MSTAR:"mstar.png",VIERA:"viera.png",PLAYSTATION:"playstation.png",JAVASCRIPT:"source.png",STYLESHEET:"stylesheet.png",WEB:"web.png",FILE:"",UNKNOWN:"unknown.png",FOLDEROPEN:"../../"+ConsoleIO.Constant.IMAGE_URL.get("tree")+"/folderOpen.gif",PROFILE:"profiles.png",FUNCTIONS:"functions.png"},ConsoleIO.ready(function(){if(!ConsoleIO.domReady){ConsoleIO.domReady=!0,function(a,b){a.commands.autocomplete=function(b){a.showHint(b,a.javascriptHint)},a.commands.submit=function(a){var c=a.getValue();c&&b.Service.Socket.emit("execute",{serialNumber:b.myApp.getActiveDeviceSerialNumber(),code:c})}}(CodeMirror,ConsoleIO);var a,b,c,d,e=document.cookie.split("; "),f=e.length;for(a=0;f>a;a++)b=e[a].split("="),c=b[0],d=b[1],ConsoleIO.Service.Storage.Store[c]=d;ConsoleIO.styleSheet=function(){var a=document.createElement("style");return a.type="text/css",a.id="console.io.style",a.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(a),a.sheet||a.styleSheet}(),ConsoleIO.Service.Socket.connect(),ConsoleIO.myApp=new ConsoleIO.App,ConsoleIO.myApp.render()}});